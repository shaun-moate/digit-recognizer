schema: '2.0'
stages:
  data_processing:
    cmd: python -m src.stages.data_processing -c "params.yaml"
    deps:
    - path: data/raw/sample_submission.csv
      hash: md5
      md5: 58e9527cf5dc55c3095d508caa6c0ef4
      size: 240909
    - path: data/raw/test.csv
      hash: md5
      md5: 9f3b56df6157e910867d03b3b9d35b9c
      size: 51118296
    - path: data/raw/train.csv
      hash: md5
      md5: 4003867bbac45a20a3367753b6a42e81
      size: 76775041
    - path: src/stages/data_processing.py
      hash: md5
      md5: 53cacf0aa879e6afb84bbaf93ce80ad9
      size: 3739
    params:
      params.yaml:
        base:
          project: digit_recognisation
          raw_data_dir: data/raw/
          processed_data_dir: data/processed/
          random_seed: 13
          device: mps
        data_processing:
          split: 0.01
    outs:
    - path: data/processed/test_processed.pt
      hash: md5
      md5: 8039e0fe9a5bbd3cf75d3ac72eea6622
      size: 87808768
    - path: data/processed/train_x_processed.pt
      hash: md5
      md5: 804a7148d0bd906c617349be513ad431
      size: 130395657
    - path: data/processed/train_y_processed.pt
      hash: md5
      md5: 0f32039f6f40fe5eb50698f335e228b5
      size: 333385
    - path: data/processed/valid_x_processed.pt
      hash: md5
      md5: abc2ac279273950a9c94e3031b593156
      size: 1317897
    - path: data/processed/valid_y_processed.pt
      hash: md5
      md5: 15e709183f31afa4d25764e6714bda57
      size: 4105
  train:
    cmd: python -m src.stages.train -c "params.yaml"
    deps:
    - path: data/processed/train_x_processed.pt
      hash: md5
      md5: 804a7148d0bd906c617349be513ad431
      size: 130395657
    - path: data/processed/train_y_processed.pt
      hash: md5
      md5: 0f32039f6f40fe5eb50698f335e228b5
      size: 333385
    - path: data/processed/valid_x_processed.pt
      hash: md5
      md5: abc2ac279273950a9c94e3031b593156
      size: 1317897
    - path: data/processed/valid_y_processed.pt
      hash: md5
      md5: 15e709183f31afa4d25764e6714bda57
      size: 4105
    - path: src/stages/train.py
      hash: md5
      md5: e4cd4816ba7befca3abb202b21742385
      size: 5707
    params:
      params.yaml:
        base:
          project: digit_recognisation
          raw_data_dir: data/raw/
          processed_data_dir: data/processed/
          random_seed: 13
          device: mps
        train:
          cudnn_enabled: false
          model_path: models/model.pth
          optimizer_path: models/optimizer.pth
          data:
            batch_size_train: 100
            batch_size_validation: 1000
            shuffle: true
          struct:
            conv1: 16
            conv2: 32
            linear1: 10
          optimizer:
            type: sgd
            learning_rate: 0.01
            momentum: 0.9
          n_epochs: 100
          log_interval: 10
    outs:
    - path: models/model.pth
      hash: md5
      md5: 290ffcb7fa6bccb49670d88a3591f38e
      size: 93947
    - path: models/optimizer.pth
      hash: md5
      md5: 1323bf7efaa7e0ae66754ca4e95f613a
      size: 94371
    - path: reports/results.csv
      hash: md5
      md5: 191009386e121a844697466728cfbe6c
      size: 4342
  eval:
    cmd: python -m src.stages.eval -c "params.yaml"
    deps:
    - path: data/processed/valid_x_processed.pt
      hash: md5
      md5: abc2ac279273950a9c94e3031b593156
      size: 1317897
    - path: data/processed/valid_y_processed.pt
      hash: md5
      md5: 15e709183f31afa4d25764e6714bda57
      size: 4105
    - path: models/model.pth
      hash: md5
      md5: 290ffcb7fa6bccb49670d88a3591f38e
      size: 93947
    - path: src/stages/eval.py
      hash: md5
      md5: 09b4204a28dd1215ed36d444a56d6d4f
      size: 1599
    params:
      params.yaml:
        eval:
          metrics_path: metrics.json
        train:
          cudnn_enabled: false
          model_path: models/model.pth
          optimizer_path: models/optimizer.pth
          data:
            batch_size_train: 100
            batch_size_validation: 1000
            shuffle: true
          struct:
            conv1: 16
            conv2: 32
            linear1: 10
          optimizer:
            type: sgd
            learning_rate: 0.01
            momentum: 0.9
          n_epochs: 100
          log_interval: 10
    outs:
    - path: metrics.json
      hash: md5
      md5: 5bcd9d0a42a19cb5138ea37cbb880412
      size: 55
  submission:
    cmd: python -m src.stages.submission -c "params.yaml"
    deps:
    - path: data/processed/test_processed.pt
      hash: md5
      md5: 8039e0fe9a5bbd3cf75d3ac72eea6622
      size: 87808768
    - path: models/model.pth
      hash: md5
      md5: 290ffcb7fa6bccb49670d88a3591f38e
      size: 93947
    - path: src/stages/submission.py
      hash: md5
      md5: c9f334d05e9c7d30d044f088bcc4ce81
      size: 2536
    outs:
    - path: reports/submission.csv
      hash: md5
      md5: 44927daae13af84daa550d6b0cf21a6b
      size: 240909
