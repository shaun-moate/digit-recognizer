schema: '2.0'
stages:
  data_processing:
    cmd: python -m src.stages.data_processing -c "params.yaml"
    deps:
    - path: data/raw/sample_submission.csv
      hash: md5
      md5: 58e9527cf5dc55c3095d508caa6c0ef4
      size: 240909
    - path: data/raw/test.csv
      hash: md5
      md5: 9f3b56df6157e910867d03b3b9d35b9c
      size: 51118296
    - path: data/raw/train.csv
      hash: md5
      md5: 4003867bbac45a20a3367753b6a42e81
      size: 76775041
    - path: src/stages/data_processing.py
      hash: md5
      md5: 66d7bd689bd5f1eaf5885e85f96248c6
      size: 3195
    params:
      params.yaml:
        base:
          project: digit_recognisation
          raw_data_dir: data/raw/
          processed_data_dir: data/processed/
          random_seed: 13
          device: mps
        data_processing:
          split: 0.1
    outs:
    - path: data/processed/test_processed.pt
      hash: md5
      md5: 90c0a529d6f622e33802cd55bac868cf
      size: 87808768
    - path: data/processed/train_x_processed.pt
      hash: md5
      md5: e2f8d0784801348b40598a4c918ed213
      size: 118541577
    - path: data/processed/train_y_processed.pt
      hash: md5
      md5: 486b3dfaf9d8ae44140c445b449ab2a3
      size: 303177
    - path: data/processed/valid_x_processed.pt
      hash: md5
      md5: f0cd5e53a290bec980faa151ae92af15
      size: 13171977
    - path: data/processed/valid_y_processed.pt
      hash: md5
      md5: 606b246fc6aa77b668afd2553c3ccd76
      size: 34377
  train:
    cmd: python -m src.stages.train -c "params.yaml"
    deps:
    - path: data/processed/train_x_processed.pt
      hash: md5
      md5: e2f8d0784801348b40598a4c918ed213
      size: 118541577
    - path: data/processed/train_y_processed.pt
      hash: md5
      md5: 486b3dfaf9d8ae44140c445b449ab2a3
      size: 303177
    - path: data/processed/valid_x_processed.pt
      hash: md5
      md5: f0cd5e53a290bec980faa151ae92af15
      size: 13171977
    - path: data/processed/valid_y_processed.pt
      hash: md5
      md5: 606b246fc6aa77b668afd2553c3ccd76
      size: 34377
    - path: src/stages/train.py
      hash: md5
      md5: 66fe582dbfa1847492b2940dc63c2236
      size: 5148
    params:
      params.yaml:
        base:
          project: digit_recognisation
          raw_data_dir: data/raw/
          processed_data_dir: data/processed/
          random_seed: 13
          device: mps
        train:
          cudnn_enabled: false
          model_path: models/model.pth
          optimizer_path: models/optimizer.pth
          data:
            batch_size_train: 64
            batch_size_validation: 100
            shuffle: true
          struct:
            conv1: 10
            conv2: 20
            linear1: 50
            linear2: 10
          learning_rate: 0.001
          momentum: 0.5
          n_epochs: 300
          log_interval: 10
    outs:
    - path: models/model.pth
      hash: md5
      md5: 36cbe9638d288b5eab5528e79319b7ac
      size: 89851
    - path: models/optimizer.pth
      hash: md5
      md5: 89cb5559d9d607a9ffd8bbb3c546145f
      size: 89955
    - path: reports/results.csv
      hash: md5
      md5: e6b24b364720e04a297d658706f87881
      size: 13188
  eval:
    cmd: python -m src.stages.eval -c "params.yaml"
    deps:
    - path: data/processed/valid_x_processed.pt
      hash: md5
      md5: f0cd5e53a290bec980faa151ae92af15
      size: 13171977
    - path: data/processed/valid_y_processed.pt
      hash: md5
      md5: 606b246fc6aa77b668afd2553c3ccd76
      size: 34377
    - path: models/model.pth
      hash: md5
      md5: 36cbe9638d288b5eab5528e79319b7ac
      size: 89851
    - path: src/stages/eval.py
      hash: md5
      md5: 09b4204a28dd1215ed36d444a56d6d4f
      size: 1599
    params:
      params.yaml:
        eval:
          metrics_path: metrics.json
        train:
          cudnn_enabled: false
          model_path: models/model.pth
          optimizer_path: models/optimizer.pth
          data:
            batch_size_train: 64
            batch_size_validation: 100
            shuffle: true
          struct:
            conv1: 10
            conv2: 20
            linear1: 50
            linear2: 10
          learning_rate: 0.001
          momentum: 0.5
          n_epochs: 300
          log_interval: 10
    outs:
    - path: metrics.json
      hash: md5
      md5: 8415a61e78d4364606eb61e54c14232a
      size: 55
  submission:
    cmd: python -m src.stages.submission -c "params.yaml"
    deps:
    - path: data/processed/test_processed.pt
      hash: md5
      md5: 90c0a529d6f622e33802cd55bac868cf
      size: 87808768
    - path: models/model.pth
      hash: md5
      md5: 36cbe9638d288b5eab5528e79319b7ac
      size: 89851
    - path: src/stages/submission.py
      hash: md5
      md5: d58defc4c99ed98f9604d2f6cf7cc59c
      size: 3123
    outs:
    - path: reports/submission.csv
      hash: md5
      md5: fe92932d5233afb387d2e8dccd9c177b
      size: 240909
